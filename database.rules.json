{
  "rules": {
    // Jobs collection - public read, admin write only
    "jobs": {
      ".read": true,
      ".write": "auth != null && (auth.token.email == 'admin@allindajobs.com' || auth.token.admin == true)",
      "$jobId": {
        ".validate": "newData.hasChildren(['title', 'company', 'category', 'description', 'contactInfo', 'createdDate'])",
        "title": {
          ".validate": "newData.isString() && newData.val().length > 0 && newData.val().length <= 200"
        },
        "company": {
          ".validate": "newData.isString() && newData.val().length > 0 && newData.val().length <= 100"
        },
        "category": {
          ".validate": "newData.isString() && (newData.val() == 'IT / Software Jobs' || newData.val() == 'Non-IT / BPO Jobs' || newData.val() == 'Government Jobs' || newData.val() == 'All Private/ Bank Jobs' || newData.val() == 'Walk-in Drive/Internships Jobs')"
        },
        "description": {
          ".validate": "newData.isString() && newData.val().length > 0 && newData.val().length <= 2000"
        },
        "contactInfo": {
          ".validate": "newData.isString() && newData.val().length > 0 && newData.val().length <= 500"
        },
        "createdDate": {
          ".validate": "newData.isString() && newData.val().matches(/^\\d{4}-\\d{2}-\\d{2}$/)"
        },
        "$other": {
          ".validate": false
        }
      }
    },
    
    // User profiles - authenticated users can read/write their own data
    "users": {
      ".read": "auth != null",
      "$uid": {
        ".read": "$uid === auth.uid || (auth.token.email == 'admin@allindajobs.com' || auth.token.admin == true)",
        ".write": "$uid === auth.uid || (auth.token.email == 'admin@allindajobs.com' || auth.token.admin == true)",
        ".validate": "newData.hasChildren(['email']) && $uid === auth.uid",
        "email": {
          ".validate": "newData.isString() && newData.val() === auth.token.email"
        },
        "displayName": {
          ".validate": "newData.isString() && newData.val().length <= 100"
        },
        "createdAt": {
          ".validate": "newData.isNumber()"
        },
        "savedJobs": {
          "$jobId": {
            ".validate": "newData.isBoolean() || newData.isNumber()"
          }
        },
        "$other": {
          ".validate": false
        }
      }
    },
    
    // Applications - users can apply for jobs
    "applications": {
      ".read": "auth != null && (auth.token.email == 'admin@allindajobs.com' || auth.token.admin == true)",
      "$applicationId": {
        ".write": "auth != null && (!data.exists() || data.child('applicantId').val() === auth.uid)",
        ".read": "auth != null && (data.child('applicantId').val() === auth.uid || auth.token.email == 'admin@allindajobs.com' || auth.token.admin == true)",
        ".validate": "newData.hasChildren(['jobId', 'applicantId', 'appliedAt'])",
        "jobId": {
          ".validate": "newData.isString() && root.child('jobs').child(newData.val()).exists()"
        },
        "applicantId": {
          ".validate": "newData.isString() && newData.val() === auth.uid"
        },
        "appliedAt": {
          ".validate": "newData.isNumber()"
        },
        "status": {
          ".validate": "newData.isString() && (newData.val() == 'pending' || newData.val() == 'reviewed' || newData.val() == 'accepted' || newData.val() == 'rejected')"
        },
        "$other": {
          ".validate": false
        }
      }
    },
    
    // App configuration - admin only
    "config": {
      ".read": true,
      ".write": "auth != null && (auth.token.email == 'admin@allindajobs.com' || auth.token.admin == true)"
    },
    
    // Statistics and analytics - admin only
    "analytics": {
      ".read": "auth != null && (auth.token.email == 'admin@allindajobs.com' || auth.token.admin == true)",
      ".write": "auth != null && (auth.token.email == 'admin@allindajobs.com' || auth.token.admin == true)"
    },
    
    // Deny access to any other paths
    "$other": {
      ".validate": false
    }
  }
}