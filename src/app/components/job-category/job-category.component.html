<div class="jc">
  <!-- Loading -->
  <div *ngIf="isLoading" class="jc-loading">
    <div class="jc-spinner"></div>
    <p class="jc-loading-text">Finding jobs...</p>
  </div>

  <!-- Jobs Content -->
  <div *ngIf="!isLoading && filteredJobs.length > 0">
    <div class="container-fluid px-0">
      <div class="row g-0">
        <!-- Left Column -->
        <div [ngClass]="categoryParam === 'health-and-career-tips' || categoryParam === 'motivation-stories' ? 'col-12' : 'col-12 col-md-9 pe-md-1'">
          <!-- Header Card -->
          <div class="jc-top-card mb-1">
            <div class="jc-header-row">
              <div class="jc-breadcrumb">
                <i class="bi bi-house-fill"></i>
                <span routerLink="/all-latest-jobs" style="cursor: pointer;">Home</span>
                <i class="bi bi-chevron-right"></i>
                <span class="jc-category-name">{{ categoryTitle }}</span>
              </div>
              <!-- <div class="jc-follow-mini">
                <span class="follow-text">Follow:</span>
                <button class="mini-social-btn mini-yt" (click)="openExternalChannel('https://www.youtube.com/@allindajobs')" title="YouTube">
                  <i class="bi bi-youtube"></i>
                </button>
                <button class="mini-social-btn mini-wa" (click)="openExternalChannel('https://whatsapp.com/channel/0029VbCLJWjCRs1nIKjUlh3p')" title="WhatsApp">
                  <i class="bi bi-whatsapp"></i>
                </button>
                <button class="mini-social-btn mini-fb" (click)="openExternalChannel('https://www.facebook.com/share/17yHma5rhP/')" title="Facebook">
                  <i class="bi bi-facebook"></i>
                </button>
                <button class="mini-social-btn mini-ig" (click)="openExternalChannel('https://www.instagram.com/allindajobs?igsh=MXJxeWl4NXdmeDVtdg==')" title="Instagram">
                  <i class="bi bi-instagram"></i>
                </button>
              </div> -->
            </div>
          </div>

          <!-- Category Pills Card -->
          <div class="jc-top-card mb-1">
            <div class="jc-pills-row">
            
              <button class="jc-pill jc-pill-all" routerLink="/all-latest-jobs" routerLinkActive="jc-pill-active" [routerLinkActiveOptions]="{exact: true}">
                <i class="bi bi-grid-3x3-gap-fill"></i>
                <span>All Jobs</span>
              </button>
                 <button *ngIf="getTodayJobsCount() > 0" class="jc-pill jc-pill-today" routerLink="/today-jobs" routerLinkActive="jc-pill-active" [routerLinkActiveOptions]="{exact: true}" style="background-color: #fff3e0; color: #e65100;">
                <i class="bi bi-clock-history"></i>
                <span>Today Posted ({{ getTodayJobsCount() }})</span>
              </button>
              <button *ngIf="getTodayWalkinsCount() > 0" class="jc-pill jc-pill-today-walkin" routerLink="/today-walkins" routerLinkActive="jc-pill-active" [routerLinkActiveOptions]="{exact: true}" style="background-color: #fce4ec; color: #c2185b;">
                <i class="bi bi-person-walking"></i>
                <span>Today Walk-ins</span>
              </button>
              <!-- <button class="jc-pill jc-pill-it" routerLink="/it-jobs" routerLinkActive="jc-pill-active" [routerLinkActiveOptions]="{exact: true}">
                <i class="bi bi-laptop-fill"></i>
                <span>IT Jobs</span>
              </button> -->
              <button class="jc-pill jc-pill-fresher" routerLink="/fresher-jobs" routerLinkActive="jc-pill-active" [routerLinkActiveOptions]="{exact: true}" style="background-color: #e8f5e9; color: #2e7d32;">
                <i class="bi bi-mortarboard-fill"></i>
                <span>Fresher Jobs</span>
              </button>
             
              <button class="jc-pill jc-pill-gov" routerLink="/government-jobs" routerLinkActive="jc-pill-active" [routerLinkActiveOptions]="{exact: true}" style="background-color: #fff3e0; color: #e65100;">
                <i class="bi bi-building-fill"></i>
                <span>Govt Jobs</span>
              </button>
              <button class="jc-pill jc-pill-prv" routerLink="/private-jobs" routerLinkActive="jc-pill-active" [routerLinkActiveOptions]="{exact: true}" style="background-color: #e8f5e9; color: #2e7d32;">
                <i class="bi bi-briefcase-fill"></i>
                <span>Private Jobs</span>
              </button>
              <button class="jc-pill jc-pill-walk" routerLink="/walk-in-drives" routerLinkActive="jc-pill-active" [routerLinkActiveOptions]="{exact: true}" style="background-color: #fce4ec; color: #c2185b;">
                <i class="bi bi-person-walking"></i>
                <span> Walk-ins</span>
              </button>
              <!-- <button class="jc-pill jc-pill-bank" routerLink="/banking-jobs" routerLinkActive="jc-pill-active" [routerLinkActiveOptions]="{exact: true}">
                <i class="bi bi-piggy-bank-fill"></i>
                <span>Banking Jobs</span>
              </button>  -->
              <button class="jc-pill" routerLink="/health-and-career-tips" routerLinkActive="jc-pill-active" [routerLinkActiveOptions]="{exact: true}" style="background-color: #e1f5fe; color: #0288d1;">
                <i class="bi bi-heart-pulse-fill"></i>
                <span>Career Tips</span>
              </button>
              <!-- <button class="jc-pill" routerLink="/motivation-stories" routerLinkActive="jc-pill-active" [routerLinkActiveOptions]="{exact: true}" style="background-color: #fff8e1; color: #ffa000;">
                <i class="bi bi-lightning-charge-fill"></i>
                <span>Motivation</span>
              </button> -->
              <button *ngIf="getTodayExpiredGovJobsCount() > 0" class="jc-pill jc-pill-today-expired" routerLink="/today-expired-gov-jobs" routerLinkActive="jc-pill-active" [routerLinkActiveOptions]="{exact: true}" style="background-color: #ffebee; color: #b71c1c;">
                <i class="bi bi-calendar-x-fill"></i>
                <span> Expired Gov Jobs</span>
              </button>
            </div>
          </div>

          <!-- Jobs Tables -->
          <div class="jc-tables-container" *ngIf="getNewJobs().length > 0">
            
            <!-- Government Jobs Table -->
            <div class="jc-table-section" *ngIf="getGovJobs().length > 0">
              <div class="jc-table-header gov-header">
                <i class="bi bi-building-fill me-2"></i>
                <div class="header-text-container">
                  <span class="header-main-text">Latest Government Jobs</span>
                  <span class="header-sub-text">(అధికారిక ప్రభుత్వ ఉద్యోగాలు)</span>
                </div>
              </div>
              <div class="table-responsive">
                <table class="table jc-custom-table">
                  <thead>
                    <tr>
                      <th class="date-col">Posted Date</th>
                      <th class="title-col">Job Title</th>
                      <th class="action-col text-center">Action</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr *ngFor="let job of getGovJobs()" (click)="viewJobDetails(job)">
                      <td class="date-cell">
                        <span class="date-badge">{{ job.createdDate | date:'dd-MMM-yyyy' }}</span>
                        <!-- <div class="time-ago">{{ getTimeAgo(job.createdDate) }}</div> -->
                      </td>
                      <td class="title-cell">
                        <div class="job-main-title">{{ job.title }}</div>
                        <div class="job-sub-meta">
                          <!-- <span class="badge bg-success-subtle text-success border border-success-subtle me-1">{{ job.category }}</span> -->
                          <span *ngIf="job.lastDateToApply" class="text-danger small fw-bold ms-1"> Last Date: {{ job.lastDateToApply | date:'dd MMM' }}</span>
                        </div>
                      </td>
                      <td class="action-cell text-center">
                        <button class="btn btn-view-job" (click)="viewJobDetails(job); $event.stopPropagation()">
                          View
                        </button>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>

            <!-- Private Jobs Table -->
            <div class="jc-table-section" *ngIf="getPrivateJobs().length > 0">
              <div class="jc-table-header pvt-header">
                <i class="bi bi-briefcase-fill me-2"></i>
              <div class="header-text-container">
                  <span class="header-main-text"> Latest Private Jobs & Walk-ins</span>
                  <span class="header-sub-text">(ప్రైవేట్ ఉద్యోగాలు)</span>
                </div>  
              </div>
              <div class="table-responsive">
                <table class="table jc-custom-table">
                  <thead>
                    <tr>
                      <th class="date-col">Posted Date</th>
                      <th class="title-col">Job Title</th>
                      <th class="action-col text-center">Action</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr *ngFor="let job of getPrivateJobs()" (click)="viewJobDetails(job)">
                      <td class="date-cell">
                        <span class="date-badge">{{ job.createdDate | date:'dd-MMM-yyyy' }}</span>
                     
                      </td>
                      <td class="title-cell">
                        <div class="job-main-title">{{ job.title }}</div>
                        <div class="job-sub-meta">
                         
                          <span *ngIf="job.category === 'Walk-in Drives' && job.walkInStartDate" class="text-danger small fw-bold ms-1">walk-In Date: {{ job.walkInStartDate | date:'dd MMM' }}{{ job.walkInEndDate ? ' - ' + (job.walkInEndDate | date:'dd MMM') : '' }}</span>
                        </div>
                      </td>
                      <td class="action-cell text-center">
                        <button class="btn btn-view-job" (click)="viewJobDetails(job); $event.stopPropagation()">
                          View
                        </button>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>

          <!-- Pagination -->
          <nav *ngIf="filteredJobs.length > jobsPerPage" class="jc-pagination mt-4">
            <ul class="pagination justify-content-center">
              <li class="page-item" [class.disabled]="currentPage === 1">
                <button class="page-link" (click)="goToPage(currentPage - 1)" [disabled]="currentPage === 1">Previous</button>
              </li>
              <li class="page-item" *ngFor="let page of [].constructor(getTotalPages()); let i = index" [class.active]="currentPage === (i+1)">
                <button class="page-link" (click)="goToPage(i+1)">{{ i+1 }}</button>
              </li>
              <li class="page-item" [class.disabled]="currentPage === getTotalPages()">
                <button class="page-link" (click)="goToPage(currentPage + 1)" [disabled]="currentPage === getTotalPages()">Next</button>
              </li>
            </ul>
          </nav>
        </div>

        <!-- Right Column - Filters -->
        <div class="col-12 col-md-3" *ngIf="categoryParam !== 'health-and-career-tips' && categoryParam !== 'motivation-stories'">
          <!-- WhatsApp Sidebar Card -->
         

          <!-- Official Company Careers (Quick Filter Section) -->
          <div class="occ-section">
            <h6 class="occ-title">
              <i class="bi bi-building-check text-primary"></i> Official Company Careers
            </h6>
            <div class="occ-types row g-2">
              <div class="col-6 col-md-6" *ngFor="let type of careerJobTypes">
                <div class="occ-type-card" [class.active]="selectedCareerType === type" (click)="filterCareersByType(type)">
                  <span class="occ-type-name">{{ type }}</span>
                </div>
              </div>
            </div>
            

            <!-- Career Links Display based on selected Job Type -->
            <div class="occ-links-container mt-3" *ngIf="selectedCareerType">
              <div class="occ-links-header d-flex justify-content-between align-items-center mb-2">
                <small class="fw-bold" style="color: #000000;">{{ selectedCareerType }} Career Links</small>
                <button class="btn btn-sm btn-link p-0 text-decoration-none fw-bold" (click)="selectedCareerType = ''" style="color: #000000; font-size: 0.75rem;">
                  <i class="bi bi-x-circle"></i> Close
                </button>
              </div>
              <div class="row g-2">
                <div class="col-12" *ngFor="let career of filteredCareers">
                  <div class="occ-link-card">
                    <span class="occ-company-name" style="color: #000000;">{{ career.company }}</span>
                    <a [href]="career.careerOfficeUrl" target="_blank" class="occ-action-link" style="color: #000000;">
                      Click here <i class="bi bi-box-arrow-up-right"></i>
                    </a>
                  </div>
                </div>
                <div class="col-12" *ngIf="filteredCareers.length === 0">
                  <p class="small mb-0 p-2 text-center border rounded bg-light" style="color: #000000; font-weight: 600;">No career links available for this category yet.</p>
                </div>
              </div>
            </div>
          </div>
 <div class="sidebar-wa-card mb-2" (click)="openExternalChannel('https://whatsapp.com/channel/0029VbCLJWjCRs1nIKjUlh3p')">
            <div class="d-flex align-items-center">
              <div class="wa-icon-box me-2">
                <i class="bi bi-whatsapp"></i>
              </div>
              <div class="wa-content">
                <span class="wa-title">Join WhatsApp</span>
                <span class="wa-subtitle">Get Instant Job Alerts</span>
              </div>
              <i class="bi bi-arrow-right-short ms-auto"></i>
            </div>
          </div>
          <div class="jc-filters">
            <div class="d-flex justify-content-between align-items-center mb-2 px-1">
              <h6 class="jc-filter-title mb-0 p-0">
                <i class="bi bi-funnel"></i>
                <span>Quick Filters by Company name</span>
              </h6>
              <button class="btn btn-sm btn-link text-danger p-0 text-decoration-none" style="font-size: 0.85rem;" (click)="clearAllFilters()" *ngIf="hasActiveFilters()">
                Clear All
              </button>
            </div>
            <hr class="jc-filter-divider my-1">
            
            <!-- Company Filter -->
            <div class="jc-filter-group mb-2">
                 <div class="jc-filter-options-scroll">
                <label class="jc-filter-option" *ngFor="let company of getUniqueCompanies()" [class.active]="selectedCompanies.includes(company)">
                  <input type="checkbox" [value]="company" [checked]="selectedCompanies.includes(company)" (change)="filterByCompany($event)">
                  <span class="jc-filter-text">{{ company }}({{ getJobCountByCompany(company) }})</span>
                </label>
              </div>
            </div>

            

          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Empty State -->
  <div *ngIf="!isLoading && filteredJobs.length === 0" class="jc-empty">
    <div>
      <div class="jc-empty-icon">
        <i class="bi bi-search"></i>
      </div>
      <h3 class="jc-empty-title">No Jobs Found</h3>
      <p class="jc-empty-text">No jobs in {{ categoryTitle.toLowerCase() }} right now.</p>
      <a routerLink="/all-latest-jobs" class="jc-back-btn">
        <i class="bi bi-arrow-left"></i>
        <span>Browse All Jobs</span>
      </a>
    </div>
  </div>
</div>
